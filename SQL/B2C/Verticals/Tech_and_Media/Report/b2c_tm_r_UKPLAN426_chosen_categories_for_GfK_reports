-- JIRA:            UKPLAN-426
-- Task:            Providing the GfK report category data selections in a SQL file

-- Author: 			Tugrul Ates
-- Date:            2023-06-27

-- Stakeholder: 	UK, DE and IT businesses
-- Description: 	Providing a SQL file for the selected category data in the GfK reports as per the Data Sharing Proposal document (https://docs.google.com/document/d/1nfR4YR1IG0rO62wMWun5stq6fDYpHOJP/edit)


-- Vertical Level Data Selections
select 
distinct case 
	when site_id = 3 and categ_lvl2_id in (20710, 69197, 185066) then 'Electronics'
	when site_id = 3 and meta_categ_id in (26395) then 'Lifestyle'
	when site_id = 3 and categ_lvl3_id in (260325) then 'Lifestyle'
	when site_id = 3 and categ_lvl2_id in (386, 238, 1202, 2624, 61573) then 'Home & Garden'
	when site_id = 3 and categ_lvl3_id in (35000, 98989) then 'Home & Garden'
	when site_id = 3 and categ_lvl3_id in (3244) then 'Parts & Accessories'
	when site_id = 3 and categ_lvl3_id in (124982, 259225,180969, 260509) then 'Business & Industrial'
	when site_id = 3 and categ_lvl2_id in (46576) then 'Parts & Accessories'
	when site_id = 3 and categ_lvl2_id in (63, 29223) then 'Collectibles'
	when site_id = 3 and meta_categ_id in (11450) then 'Fashion'
	when site_id = 3 and categ_lvl4_id in (3937, 31387, 260326) then 'Fashion'  -- This has been added as per Keith Metcalfe's request (UKPLAN-418)
	else bsns_vrtcl_name 
	end as vertical  -- This column takes the category data adjustments for the UK business
,meta_categ_id
,meta_categ_name
,categ_lvl2_id
,categ_lvl2_name
,categ_lvl3_id
,categ_lvl3_name
,leaf_categ_id
,leaf_categ_name

from DW_CATEGORY_GROUPINGS

where 1 = 1
and site_id in (3, 77, 101)  --3:United Kingdom, 77:Germany, 101: Italy
and bsns_vrtcl_name in ('Electronics', 'Media')
and meta_categ_id in 
(267
,293
,619
,625
,1249
,11232
,11233
,11700
,12576
,15032
,40005
,58058
,131090
)

and categ_lvl2_id in 
(1
,162
,165
,192
,280
,297
,304
,309
,381
,617
,618
,631
,1424
,1497
,1500
,2329
,3187
,3270
,3286
,3323
,3326
,3516
,3676
,3944
,4684
,9355
,9394
,11071
,11176
,11189
,11724
,12922
,14961
,14969
,15052
,15069
,15200
,18793
,20710
,20833
,21162
,25298
,27432
,28179
,29792
,30078
,30090
,31388
,31530
,32852
,38331
,38583
,38635
,41676
,43304
,45065
,45089
,45110
,48446
,48458
,48644
,51004
,52473
,52554
,54968
,63821
,64353
,69323
,71582
,74944
,78997
,86722
,118254
,132975
,135221
,136699
,139971
,139973
,146492
,150044
,156595
,156597
,162497
,171228
,171243
,171485
,171833
,171957
,171961
,175672
,175673
,175696
,175698
,175740
,175744
,175837
,176970
,176983
,176984
,176985
,178893
,178894
,179697
,180014
,180235
,181939
,182064
,182073
,182074
,182094
,182098
,182174
,182175
,182882
,183062
,183067
,184644
,185066
,259696
,259701
,260000
,261186
,262053
,262054
)

and categ_lvl3_id in
(
1
,162
,164
,167
,169
,170
,177
,179
,182
,185
,193
,201
,279
,280
,296
,297
,302
,304
,309
,377
,381
,431
,575
,617
,618
,711
,1071
,1105
,1244
,1245
,1311
,1491
,1603
,2328
,2330
,2331
,2335
,2336
,2337
,2375
,3271
,3314
,3317
,3319
,3323
,3330
,3516
,3668
,3680
,3702
,3709
,3761
,3767
,3768
,3783
,4193
,4201
,4616
,4669
,4670
,4684
,4689
,4690
,4693
,4702
,4710
,4785
,4786
,4787
,4790
,9355
,9425
,9972
,11071
,11175
,11183
,11195
,11205
,11226
,11442
,11722
,11724
,11725
,12921
,12922
,13725
,14295
,14906
,14964
,14969
,14970
,14971
,14981
,14985
,14990
,15048
,15051
,15053
,15054
,15056
,15088
,15216
,15220
,15230
,15235
,15238
,15250
,16145
,18835
,18837
,18838
,18839
,18840
,18841
,18854
,18871
,19590
,19656
,19699
,20034
,20311
,20315
,20349
,20357
,20373
,20381
,20667
,20715
,21198
,22610
,22635
,22642
,22784
,23160
,23895
,25319
,25321
,25326
,27386
,27432
,29523
,29778
,29792
,29860
,29875
,29945
,29965
,29967
,29970
,29973
,29980
,29994
,30038
,30040
,30059
,30085
,30088
,30093
,30095
,30097
,30889
,31197
,31388
,31492
,31493
,31509
,31510
,31519
,31529
,31534
,32834
,32995
,32996
,32997
,33929
,33963
,34292
,35029
,35190
,38250
,38331
,38583
,39803
,39804
,39976
,40054
,40979
,41373
,41676
,41859
,42000
,42017
,42190
,42231
,42425
,42437
,42447
,42456
,43304
,43307
,43308
,43440
,43448
,43479
,43563
,44932
,44980
,44995
,44996
,44999
,45002
,45065
,45089
,45113
,45114
,45733
,47779
,48460
,48479
,48515
,48571
,48618
,48619
,48626
,48633
,48644
,48645
,48647
,48649
,48655
,48656
,48677
,48831
,49230
,50203
,50503
,50506
,50508
,50590
,50595
,50596
,50597
,50602
,51004
,51052
,51071
,51082
,51086
,51167
,51168
,51169
,51197
,51240
,52462
,52473
,52554
,53250
,53251
,56169
,58297
,58300
,58353
,58540
,58543
,58698
,58707
,58717
,61082
,61083
,61084
,61085
,61312
,61336
,61395
,61760
,61816
,61839
,61840
,63821
,64343
,64345
,64352
,64354
,64588
,64602
,64604
,64605
,64606
,64619
,67262
,67339
,67807
,67858
,67870
,67880
,67882
,68030
,69496
,69573
,69960
,69962
,69963
,69965
,69967
,71258
,71407
,71574
,71583
,71584
,71585
,72406
,73368
,73374
,73382
,73839
,74922
,74927
,74941
,74944
,75518
,77739
,78999
,79000
,79001
,79003
,79007
,79845
,79846
,80015
,80053
,80077
,80133
,80183
,80225
,80356
,80390
,81741
,81967
,81970
,82285
,82286
,83857
,83880
,84079
,85491
,86720
,86723
,88468
,88665
,88667
,88668
,88758
,89161
,90733
,90734
,90838
,91384
,91497
,91500
,96907
,96915
,96954
,96964
,96969
,96991
,98830
,99231
,99265
,99269
,101270
,101355
,101366
,101642
,101643
,106447
,107894
,109256
,111418
,111422
,111694
,112529
,112664
,116309
,116346
,116848
,116852
,116868
,117042
,117044
,117045
,118254
,120869
,121464
,122649
,122962
,123417
,123422
,124848
,131511
,131542
,132297
,132975
,132998
,136699
,139835
,139968
,139971
,139973
,146493
,146504
,149958
,149971
,149972
,149973
,149975
,149987
,150044
,151226
,155707
,155823
,156595
,156597
,157158
,157161
,158816
,158817
,158837
,158840
,158845
,158846
,158906
,158911
,162028
,162044
,162045
,162046
,162053
,162075
,162480
,162485
,163768
,163769
,163826
,163829
,163862
,166030
,167928
,167930
,167943
,168058
,168059
,168068
,170066
,170067
,170083
,170088
,170089
,170597
,171223
,171273
,171485
,171668
,171813
,171814
,171820
,171821
,171826
,171831
,171833
,171837
,171839
,171858
,171898
,171918
,172011
,172510
,172511
,172513
,172514
,175671
,175674
,175677
,175678
,175679
,175680
,175687
,175688
,175689
,175690
,175696
,175699
,175700
,175707
,175708
,175709
,175710
,175711
,175719
,175720
,175721
,175729
,175741
,175742
,175744
,175833
,175835
,175837
,176971
,176972
,176973
,176974
,176975
,176976
,176977
,176978
,176979
,176980
,176981
,176982
,176983
,176984
,176985
,177022
,177023
,177024
,177025
,178893
,178894
,179406
,179697
,180235
,180248
,181948
,181968
,182065
,182066
,182067
,182068
,182069
,182073
,182075
,182077
,182085
,182086
,182088
,182089
,182090
,182091
,182092
,182093
,182095
,182096
,182097
,182098
,182103
,182104
,182110
,182111
,182174
,182175
,182179
,182180
,182969
,183063
,183064
,183065
,183066
,183068
,183069
,183070
,183071
,183072
,183073
,183074
,183078
,183502
,183503
,184618
,184637
,184638
,184642
,184645
,184647
,185034
,185044
,185054
,185058
,185065
,258042
,258046
,259482
,259696
,259701
,260000
,260137
,260144
,260307
,260315
,260316
,260317
,260318
,261186
,262053
,262054
,262426
)
;	



--Additional Tech & Media related categories

select
distinct case 
	when site_id = 3 and categ_lvl2_id in (20710, 69197, 185066) then 'Electronics'
	when site_id = 3 and meta_categ_id in (26395) then 'Lifestyle'
	when site_id = 3 and categ_lvl3_id in (260325) then 'Lifestyle'
	when site_id = 3 and categ_lvl2_id in (386, 238, 1202, 2624, 61573) then 'Home & Garden'
	when site_id = 3 and categ_lvl3_id in (35000, 98989) then 'Home & Garden'
	when site_id = 3 and categ_lvl3_id in (3244) then 'Parts & Accessories'
	when site_id = 3 and categ_lvl3_id in (124982, 259225,180969, 260509) then 'Business & Industrial'
	when site_id = 3 and categ_lvl2_id in (46576) then 'Parts & Accessories'
	when site_id = 3 and categ_lvl2_id in (63, 29223) then 'Collectibles'
	when site_id = 3 and meta_categ_id in (11450) then 'Fashion'
	when site_id = 3 and categ_lvl4_id in (3937, 31387, 260326) then 'Fashion'  -- This has been added as per Keith Metcalfe's request (UKPLAN-418)
	else bsns_vrtcl_name 
	end as vertical  -- This column takes the category data adjustments for the UK business
,meta_categ_id
,meta_categ_name
,categ_lvl2_id
,categ_lvl2_name
,categ_lvl3_id
,categ_lvl3_name

from DW_CATEGORY_GROUPINGS

where 1=1
and site_id in (3, 77, 101)
and meta_categ_name in
(
'Baby'
,'Sporting Goods'
,'Sport'
,'Garten & Terrasse'
,'Garden & Patio'
,'Health & Beauty'
,'Home & Garden'
,'Fashion'
)

and categ_lvl2_name in 
(
'Safety'
,'Sicherheit'
,'Fitness, Running & Yoga'
,'Fitness & Jogging'
,'Motor-Gartengeräte & -zubehör'
,'Garden Power Tools & Equipment'
,'Scooters'
,'Funsport'
,'Cycling'
,'Radsport'
,'Grills, Heizstrahler & Picknickzubehör'
,'Outdoor Heating, Cooking & Eating'
,'Shaving & Hair Removal'
,'Hair Care & Styling'
,'Oral Care'
,'Casa arredamento e bricolage'
,'Elettrodomestici'
,'Giardino e arredamento esterni'
,'Bellezza e salute'
)

and categ_lvl3_id in 
(
20435
,28059
,42226
,44075
,47349
,50388
,71268
,71273
,71277
,74469
,79691
,11844
,11858
,31770
,37802
,67408
,106317
,177659
,631
,3187
,45733
,20667
,42231
,43563
,20715
,38250
,71258
,260307
,29518
,181033
,25863
,20727
,181003
,43560
,177017
,149242
,11854
,31762
)
;