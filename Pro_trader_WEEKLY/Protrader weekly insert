-- part 1 capture listings quality metrics - this is done as a weekly capture

drop table if exists P_awang_ops_T.prot_samp_1_base1;

CREATE TABLE  P_awang_ops_T.prot_samp_1_base1  AS

(select 
retail_year,
retail_week,
case when categ_lvl2_id in (20710, 69197, 185066) then 'Electronics' 
when meta_categ_id in (26395) then 'Lifestyle'
when categ_lvl2_id in (386, 238, 1202, 49019, 183446, 80546, 222, 11731, 1082, 767, 233, 2613, 1188, 1039, 11743, 19169, 2562, 2616, 436, 14737, 2631, 2624, 717, 16486, 61573,64808,92074, 246) then 'Home & Garden'
when categ_lvl3_id in (35000) then 'Home & Garden'
when categ_lvl3_id in (3244) then 'Parts & Accessories'
when categ_lvl2_id in (46576) then 'Parts & Accessories'
else bsns_vrtcl_name end as new_vertical, 

case 
when a.seller_id in (1479069056, 1380293356,	1234196568,	132320007,	1133200523,	1193523886,	193399590,	199494040,	1216132208,	1004423012,	306804503,	170339741,	884786058,	1734319175,	750406513,	669471442,	985965288,	15527484,	1516330637,	1238366896,	56095475,	595251680,	917193540,	480992494,	1855727464,	1547326162,	1050275365,	649354544,	74494613,	1098596222,	1503867999,	325374982,	63019472,	594742277,	184841304,	1761424189,	1007729348,	46985308,	180827173,	118378913,	1034462370,	61839655,	1718009593,	1196059765,	1322507086,	673986443,	149228830,	967042915,	1074635592,	365735231,	38557418,	132952595,	804061756,	1030804679,	1322602121,	69463821,	1831563113,	710825413,	1187009635,	944564631,	1071478032,	1254050094,	1421389290,	2086025813,	174425961,	1410674601,	1110394668,	1296853448,	1355250729,	92761721,	781162094,	1779195103,	38990840,	1702921347,	97476529,	504829495,	300603540,	224523539,	1936180706,	1688196638,	2229939146,	902433898,	1178372338,	44672077,	1211126559,	1150021366,	1979842360,	1845057527,	1930258430,	2110255131,	1180847104,	1875360792,	2111047066,	1615283964,	1918040376,	1218371867,	2120836601,	1055061407,	57637208,	2125957842,	1048798854,	1307586654,	1950770433,	1873729783,	130067954,	1478551076,	1171583855,	1805068928,	55636349,	841375365,	209737490,	345951232,	2160403857,	1062541899,	1181378934,	1073928258,	1065976034,	486619000,	62308769,	287838529,	1155940152,	1314045480,	648357984,	1668870720,	2067803989,	699890489,	146732626,	87217494,	1669034850,	30802116,	2231234088,	1149473447,	1088471505,	1278791524,	191262728,	1231362947,	1592670226,	57840841,	1162684051,	646712244,	1302242738,	1281178189,	1195407045,	1458178587,	1202603417,	1565333127,	1171382479,	2181018137,	126929623,	1183218560,	1233561601,	1437437796,	1034142459,	116418125,	1069883169,	216411815,	1099495376,	1174275765,	128319745,	803563110,	1601299011,	134304482,	1142797381,	1120406464,	1822238312,	1555901602,	1171070098,	2216664379,	2355684642,	1552208426,	2105251860,	1948608649) then 'Luxury Protrader'
when a.seller_id in (1111855945, 1777880243,	1689979588,	1038909825,	964684763,	1043348047,	1408694416,	223773633,	1032815592,	1338330763,	1065039245,	658224228,	159695522,	671087341,	1605052446,	1018460518,	91010788,	1557973695,	211001757,	1448113603,	1112735640,	1091581819,	1455471350,	1587148581,	1497006411,	299670676,	604449838,	1921862925,	1097089075,	1105664390,	1278792583,	2268403352,	1073520127,	1289200779,	1116389974,	969782967,	139187781,	1035877556,	223731502,	1697500309,	116645228,	1248441771,	1544201753,	1151004813,	1299877105,	1048160565,	145301962,	2175086844,	1173401256,	1136646045,	376368308,	364240825,	1241440038,	1630261675,	110722372,	1079928128,	1344753849,	1948431406,	1985168000,	1503728878,	1488575577,	2050289472,	74236291,	987062364,	67918233,	1040307777,	1681536623,	1000551329,	438047215,	1050111690,	1586751395,	204461300,	674198409,	1083102231,	1427742195,	1670370201,	945135290,	1735043340,	1932682922,	1030415239,	1132891160,	1133028530,	1124647926,	198433353,	1326464616,	1921787131,	631292606,	189909922,	1488076759,	106719803,	39941229,	1048422266) then 'Personalised Protrader'
when a.seller_id in (779492056,	1622388726,	1134308905,	1064517454,	1104420930,	81989834,	1220266750,	1675702526,	56264907,	605853908,	438132240,	195651817,	1644692192,	1378664255,	1001729106,	2140414117,	1169202250,	2163678342,	133251303,	2210493957,	1106029208,	2293694103,	127004873,	118945299,	222043520,	182186079) then 'Prelove Protrader'
when a.seller_id in (2173190933, 60048792,	1187537835,	1598773338,	701957789,	353759803,	1808471177,	84559342,	1001102981,	1931596549,	1813908589,	1652342234,	1410062562,	87653265,	223665470,	1198402782,	2157976874,	1134356749,	100451494,	145445435,	801437291,	145689878,	166747440,	1116997884,	1487112643,	1031060546,	688465405,	1206560111,	1485367886,	826509308,	1018283539,	1065390620,	1150356354,	861108857,	1209045083,	361792527,	988136097,	775459505,	1171188043,	2021062629,	299502959,	40248891,	1511863763,	509007270,	65180630,	198022355,	293055683,	114914015,	74398255,	128319745,	1232524918,	844826217,	1461480454,	371252506,	1178211874,	679129159,	121322442) then 'SBU Protrader'
when meta_categ_id in (1,64482) and categ_lvl3_id in (122601,183454,106485,19119,53600,183456,19145,2885,183444,19128,27394,112979,180339,112972,106534,53606,141755) then 'Protrader Memorabilla'
when meta_categ_id in (11450) and categ_lvl3_id in (1059,93427,4250,9355,179753,179853,180027,35559,171107,49790,180029,180028,178996,178998,180034,178030,180033) then 'Protrader Mens Clothing'
when meta_categ_id in (11450) and categ_lvl3_id in (15724,3034,169291,4251) then 'Protrader Womens Fashion'
when meta_categ_id in (131090) and categ_lvl3_id in (179753,179853,180027,35559,171107,49790,180029,180028,178996,178998,180034,178030,180033,177962,49899,179752,185062) then 'Protrader Motorcycle Parts'
when meta_categ_id in (131090) and categ_lvl3_id in (43990,179421,183745,179496,43986,179474,43998,179443,179469,179492,43985,179491,174133,179463,179494,108798,179489,179495,179503,179490,179501,179502,174135,179497,179493,179498,180156,179500,179488,174128,179499) then 'Protrader Automotive Equipment'
when meta_categ_id in (20081,870) and categ_lvl3_id in (2213,63565,123466,2203,63585,64986,98440,63561,37919,4708,100906,70041,63518,98434,63569,2212,70043,98444,70039,2714,37978,955,70032,2742,13,184436,63581,98436,100905,98931,66638,98442,1207,37943,64963,64979,70057,63557,12,112089,63516,63553,100907,63549,37910,64961,37934,37914,66851,25,1208,69471,64971,112084,70054,98454,70046,70061,1212,96768,50707,2818,63577,98430,70044,70059,101669,60201,37907,96757,4175,4771,2810,1219,37917,2220,66637,66637,63589,4228,60209,98432,70050,18883,20087,60330,37915,109114,88,4219,1213,4218,79949,2809,37912,20117,98438,2805,80102,37913,116556,4221,100904,112160,361,2803,63519,2763,64981,4171,10551,69472,4230,18879,18880,20834,69473,109108,97026,101668,2795,63520,2815,2221,70052,37944,101665,100908,98468,121472,70053,109111,167948,2219,123463,112872,1214,70049,100925,109109,109113,64958,91101,64973,109107,112159,101663,4229,2796,91103,101666,4223,13850,109110,18876,2798,362,2224,123460,37905,1210,2778,22608,73469,2223,20085,101662,109112,70048,112869,462,97025,2194,123462,101667,100901,101661,23048,358,64959,66834,97021,1234,64991,27357,64987,6114,65006,65010,70063,65020,73464,98466,2776,37942,4176,79947,112090,65009,91102,86,2782,68267,4172,70085,68268,4387,91100,2761,75683,70083,20088,156322,70066,80099,64952,2816,18913,453,2760,108817,18917,101683,108816,20095,18896,25620,65014,70077,123455,65022,101678,4173,181727,37906,79948,2789,64984,65015,4222,123454,2781,64983,98450,18894,97024,2204,2811,70084,145821,97023,63548,64989,18903,65012,66833,64985,101670,70071,65004,2797,123457,65013,18906,112868,2751,75685,70080,65019,97022,4938,70076,4233,70069,101675,100928,37918,109106,70068,70065,75686,98448,101681,101674,21197,184439,72517,37908,123453,101676,106459,72519,109095,70074,179654,70087,37975,101679,70075,2769,63624,65018,97020,98462,101671,2756,72516,101684,123458,72520,64990,156320,98452,75684,75681,37977,65008,101680,123456,98464,101673,101682,70070,72518,184438,145820,66850,37964,4170,22422,70081,151725,65005,65028,65029,37976,592,105882,65030,65027,63595) then 'Protrader Antiques Pottery & Glass'
when meta_categ_id in (220) and categ_lvl3_id in (19205,1634,49020,1628,437,439,441,1036,7111,16479,1633,1522,183447,19001,258041,258040,52338) then 'Protrader Toys & Games'
when meta_categ_id in (26395) and categ_lvl3_id in (260745,67589,75042,75036,180931,36431,180942,72873,180951,82593,260818,75041,180933,260774,260781,113913,67422) then 'Protrader Health Oral and Vision Care'
when meta_categ_id in (293) and categ_lvl3_id in (11071,14990,14970,168058,61312,48647,32834,48656,81741,14964,4787,14971,175708,14981,64619,163768,175837,116868,48645,175741,61336,15088,61395,48649,184637,22635,50595,258042,175721,4786,184647,50597,175719,3271,71574,73368,175742,71585,149958,50596,122649,258046,3317,73374,31197,183074,64588,183078,163826,73382,67807,149975,184638) then 'Protrader TV & Audio'
when meta_categ_id in (888) and categ_lvl3_id in (179985,	179973,	261028,	261030,	179961,	179978,	179965,	384,	180001,	261031,	29723,	178885,	261029,	62143,	20871,	20870,	83053,	70898,	62230,	13343,	81624,	2917,	20869,	101727,	148908,	151562,	71154,	47344,	1301,	16260,	16264,	16263,	23830,	16265,	36317,	91565,	47357,	23825,	101713,	50883,	58128,	151560,	112965,	62124,	21196,	21208,	2023,	62125,	73931,	75183,	95096,	57261,	2906,	21558,	72567,	72568,	109124,	101688,	109125,	101689,	101690,	109123,	112879,	21213,	21568,	21569,	73180,	21211,	75188,	101730,	91569,	73181,	75189,	1292,	75185,	90879,	75195,	123708,	50814,	30106,	97046,	101685,	75204,	50816,	50815,	109117,	109116,	75205,	123469,	101719,	101686,	101687,	21233,	260696,	21225,	1303,	260717,	260376,	260672,	260720,	151534,	72577,	72576,	2907,	72578,	117102,	109132) then 'Protrader Sports'
else 'Other'
            END AS INVENTORY_PROP,


meta_categ_id,
categ_lvl2_id,
categ_lvl3_id,
categ_lvl3_name,
a.seller_id,
slr_categ_ll_cnt,
OD_slr_L3_ELL_CNT,
OD_SLR_LL_TO_GOAL_CNT,
MB_SLR_L3_ELL_CNT,
MB_SLR_LL_TO_GOAL_CNT,
SE_SLR_L3_LL_ALL_PCT *slr_categ_ll_cnt as SE_SLR_L3_ELL_CNT,
SE_SLR_LL_TO_Goal_CNT,
PL_SLR_L3_ELL_CNT,
PL_SLR_LL_TO_Goal_CNT,
SLR_lvl3_watchers_CNT,
FNF_SLR_L3_LL_PCT*slr_categ_ll_cnt/100 as FNF_SLR_L3_ELL_CNT,
FNF_SLR_LL_TO_Goal_CNT,
NDD_SLR_L3_LL_PCT*slr_categ_ll_cnt/100 as NDD_SLR_L3_ELL_CNT,
NDD_SLR_LL_TO_Goal_CNT,
DR_30_SLR_L3_LL_PCT*slr_categ_ll_cnt/100 as DR_30_SLR_L3_ELL_CNT,
DR_30_SLR_LL_TO_Goal_CNT,
CC_SLR_L3_LL*slr_categ_ll_cnt/100 as CC_SLR_L3_ELL_CNT,
CC_SLR_LL_TO_Goal_CNT
from P_MDALL_V.SLR_LVL3_CAT_DTL a -- this table refreshed on a weekly basis capture up to L3 level, from HIVE team
left outer JOIN ACCESS_VIEWS.DW_CAL_DT AS CAL
ON CAL.CAL_DT = a.cal_dt
inner join P_awang_opt_T.protrader_2021_Q2 s -- this is the table contain protrader sellers - replace this with seller you need to track
on a.seller_id = s.user_id 
);





drop table  if exists P_awang_ops_T.prot_samp_1_base2;
CREATE TABLE  P_awang_ops_T.prot_samp_1_base2  AS
(select a.*,
meta_categ_name,
categ_lvl2_name
from P_awang_ops_T.prot_samp_1_base1 a

    INNER JOIN ( select meta_categ_id, meta_categ_name, count(*) as entries  from ACCESS_VIEWS.DW_CATEGORY_GROUPINGS where site_id = 3 group by 1,2 
 qualify ROW_NUMBER() over  ( partition by  meta_categ_id order by entries desc) = 1
 )  AS CAT
        ON a.meta_categ_id = cat.meta_categ_id
		
      INNER JOIN ( select categ_lvl2_id, categ_lvl2_name, count(*) as entries  from ACCESS_VIEWS.DW_CATEGORY_GROUPINGS where site_id = 3 group by 1,2 
 qualify ROW_NUMBER() over  ( partition by  categ_lvl2_id order by entries desc) = 1
 )  AS CATa
        ON a.categ_lvl2_id = cata.categ_lvl2_id
		
		 INNER JOIN ( select categ_lvl3_id, categ_lvl3_name, count(*) as entries  from ACCESS_VIEWS.DW_CATEGORY_GROUPINGS where site_id = 3 group by 1,2 
 qualify ROW_NUMBER() over  ( partition by  CATEG_LVL3_id order by entries desc) = 1
 )  AS CATaa
        ON a.categ_lvl3_id = cataa.categ_lvl3_id
		);



drop table P_awang_ops_T.prot_samp_1_gmv;
CREATE TABLE  P_awang_ops_T.prot_samp_1_gmv  AS
(SELECT
RETAIL_YEAR,
retail_week,
categ_lvl3_id,
ck.seller_id,
SUM(CK.QUANTITY) AS BI
    ,SUM(CAST(CK.QUANTITY AS DECIMAL(18,2))* CAST(CK.ITEM_PRICE AS DECIMAL(18,2))*CAST(SSA.CURNCY_PLAN_RATE AS DECIMAL(18,2))) AS GMV
   FROM  DW_CHECKOUT_TRANS ck 
    INNER JOIN ( select CURNCY_PLAN_RATE,CURNCY_ID from  ACCESS_VIEWS.SSA_CURNCY_PLAN_RATE_DIM group by 1,2)AS SSA 
        ON SSA.CURNCY_ID = CK.LSTG_CURNCY_ID     
        
    INNER JOIN ( select meta_categ_id, CATEG_LVL2_ID, categ_lvl2_name, categ_lvl3_name, categ_lvl3_id,LEAF_CATEG_ID,SITE_ID,BSNS_VRTCL_NAME   from ACCESS_VIEWS.DW_CATEGORY_GROUPINGS where site_id = 3 group by 1,2,3,4,5,6,7,8 )  AS CAT
        ON CK.LEAF_CATEG_ID = CAT.LEAF_CATEG_ID
        AND CK.SITE_ID = CAT.SITE_ID

        
    INNER JOIN ACCESS_VIEWS.DW_CAL_DT AS CAL
        ON CAL.CAL_DT = CK.CREATED_DT
        AND CAL.RETAIL_YEAR in (2022) and age_for_rtl_week_id = -1 
        
inner join  (select seller_id from P_awang_ops_T.prot_samp_1_base1 group by 1) fs
on ck.seller_id = fs.seller_id
    WHERE 1=1
and  SLR_CNTRY_ID = 3 --UK sellers
and ck.site_id = 3 
AND RPRTD_WACKO_YN = 'N'
        AND AUCT_END_DT >= '2017-12-20'
        AND CREATED_DT >= '2017-12-20'     
    GROUP BY 1,2,3,4);
	
	drop table P_awang_ops_T.prot_samp_1_foutput;
CREATE TABLE  P_awang_ops_T.prot_samp_1_foutput AS
(select a.*,
b.retail_year as GMV_retail_year,
b.retail_week as GMV_retail_week,
GMV,
BI

from P_awang_ops_T.prot_samp_1_base2 a

left outer join P_awang_ops_T.prot_samp_1_gmv b
on a.seller_id = b.seller_id
and a.categ_lvl3_id = b.categ_lvl3_id);

-- GMV part actually redundent in this data pull, as for part 2 we decide to pull GMV directly

	drop table if exists P_awang_ops_T.prot_samp_1_foutput2;
CREATE TABLE  P_awang_ops_T.prot_samp_1_foutput2 AS
(select 
retail_year,
retail_week,
case when GMV_retail_year is null then retail_year else GMV_retail_year end as retail_year_GMV,
case when GMV_retail_week is null then 6 else GMV_retail_week end as retail_week_GMV,
new_vertical,
meta_categ_id,
meta_categ_name,
categ_lvl2_id,
categ_lvl2_name,
categ_lvl3_id,
categ_lvl3_name,
INVENTORY_PROP,
seller_id,
user_slctd_id,
SLR_CATEG_LL_CNT as total_listing_cnt,
OD_SLR_L3_ELL_CNT as OD_listing_cnt,
OD_SLR_LL_TO_GOAL_CNT as OD_listing_goal,
MB_SLR_L3_ELL_CNT as MB_listing_cnt,
MB_SLR_LL_TO_GOAL_CNT as MB_listing_goal,
SE_SLR_L3_ELL_CNT as SE_listing_cnt,
SE_SLR_LL_TO_GOAL_CNT as SE_listing_goal,
PL_SLR_L3_ELL_CNT as PL_listing_cnt,
PL_SLR_LL_TO_GOAL_CNT as PL_listing_goal,
SLR_LVL3_WATCHERS_CNT as no_of_watchers,
FNF_SLR_L3_ELL_CNT as fast_Free_LL_CNT,
FNF_SLR_LL_TO_GOAL_CNT as fast_free_LL_goal,
NDD_SLR_L3_ELL_CNT as Next_Day_delivery_ll_cnt,
NDD_SLR_LL_TO_GOAL_CNT as Next_day_delivery_goal,
DR_30_SLR_L3_ELL_CNT as Day_30_return_LL_cnt,
DR_30_SLR_LL_TO_GOAL_CNT as Day_30_return_goal,
CC_SLR_L3_ELL_CNT as click_collect_cnt,
CC_SLR_LL_TO_GOAL_CNT as click_collect_goal,
(GMV) as gmv,
(BI) as BI
from P_awang_ops_T.prot_samp_1_foutput f
inner join dw_users u on f.seller_id = u.user_id);

	drop table if exists P_awang_ops_T.prot_samp_1_sellerst;
CREATE TABLE  P_awang_ops_T.prot_samp_1_sellerst AS
(select 
a.seller_id,
CASE WHEN SPS.SPS_SLR_LEVEL_CD = 1 THEN 'eTRS' WHEN SPS.SPS_SLR_LEVEL_CD = 2 THEN 'Above Standard' WHEN SPS.SPS_SLR_LEVEL_CD = 3 THEN 'Standard' WHEN SPS.SPS_SLR_LEVEL_CD = 4 THEN 'Below Standard' ELSE 'No seller standard'END AS SELLER_STANDARD
from
(select seller_id
from P_awang_ops_T.prot_samp_1_foutput2
group by 1) a 
        
LEFT JOIN (select USER_ID,
SPS_SLR_LEVEL_CD, 
last_eval_Dt from  PRS_RESTRICTED_V.SPS_LEVEL_METRIC_SUM X 
where SPS_EVAL_TYPE_CD = 1 AND SPS_PRGRM_ID = 3 group by 1,2,3 qualify (row_number() over (partition by user_id order by last_eval_Dt desc))=1) SPS
ON a.seller_id = sps.user_id) ;

-- part 2 GMV only - no need for weekly insert, can run restrospective data

	drop table if exists P_awang_ops_T.prot_samp_1_gmv2;
CREATE TABLE  P_awang_ops_T.prot_samp_1_gmv2 AS
(SELect
RETAIL_YEAR,
retail_week,
case when categ_lvl2_id in (20710, 69197, 185066) then 'Electronics' 
when meta_categ_id in (26395) then 'Lifestyle'
when CATEG_LVL3_ID in (260325) then 'Lifestyle'
when categ_lvl2_id in (386, 238, 1202, 49019, 183446, 80546, 222, 11731, 1082, 767, 233, 2613, 1188, 1039, 11743, 19169, 2562, 2616, 436, 14737, 2631, 2624, 717, 16486, 61573, 246) then 'Home & Garden'
when categ_lvl3_id in (35000, 98989) then 'Home & Garden'
when categ_lvl3_id in (3244) then 'Parts & Accessories'
when categ_lvl3_id in (124982, 259225,180969, 260509) then 'Business & Industrial'
when categ_lvl2_id in (46576) then 'Parts & Accessories'
when categ_lvl2_id in (63, 29223) then 'Collectibles'
else bsns_vrtcl_name end as new_vertical, 


case 
when ck.seller_id in (1822238312, 2319487417, 97654211, 236769109, 1043576467, 1397384139, 128319745, 1034142459, 1437437796, 1233561601, 1948608649, 1183218560, 126929623, 2181018137, 1171382479, 1195407045, 1281178189, 2105251860, 1552208426, 2355684642, 2216664379, 1171070098, 345951232, 841375365, 2067803989, 1171583855, 1478551076, 1873729783, 1048798854, 2125957842, 57637208, 1055061407, 2120836601, 1218371867, 1918040376, 1615283964, 1211126559, 1278791524, 902433898, 2229939146, 1688196638, 504829495, 97476529, 1702921347, 1779195103, 1296853448, 174425961, 2086025813, 1875360792, 1254050094, 1071478032, 944564631, 1180847104, 710825413, 1831563113, 2231234088, 69463821, 1930258430, 1322602121, 1030804679, 804061756, 1845057527, 149228830, 673986443, 1322507086, 1979842360, 1718009593, 594742277, 1547326162, 1855727464, 1238366896, 669471442, 750406513, 306804503, 1004423012, 1216132208, 1234196568, 1479069056, 1397384139, 1479069056, 1009683250, 1183218560, 1034142459, 221134935, 1070857520, 2110404836, 1055061407, 1234196568, 2048417966, 768627758, 1555901602, 1487854181, 1122669470, 2231234088, 2105251860, 1547326162, 1041370741, 1550157301, 669471442, 306804503, 930081697, 779612483, 182186079, 1087077138, 1127480607, 236769109, 1322602121, 1281178189, 1319829084, 1456495330, 100578750, 594742277, 460349390, 190640570, 1615283964, 1302242738, 979078490, 1478551076, 1337360836, 1330257361, 1870993654, 2212431295, 128319745, 2130558165, 2218063338, 2216664379, 1396992496, 2362554515, 1855727464, 605853908, 345951232, 141590080, 2034362233, 1043576467, 1845175424, 1552208426, 1279792063, 1437437796, 673986443, 1153095139, 2355684642, 1116140796, 1415417245, 114749585, 804061756, 1195407045, 9921989, 1764998535, 170197795, 1322507086, 502037733, 944564631, 126929623, 915563161, 1171070098, 750406513, 673291958, 1129053078, 163749451, 1625091928, 1084443813, 1586278885, 1233561601, 1773902988, 2206839837, 1024114570, 710105941, 939261259, 1311951839, 1698367827, 134271887, 1968576336, 1278791524, 1156735193, 1187728583, 855533213, 1579448114) then "Protrader Luxury Sneakers" 
when ck.seller_id in (1417329361, 127004873, 1380293356, 699890489, 132952595, 1314045480, 1150021366, 118945299, 1193523886, 1138703637, 1155940152, 287838529, 62308769, 803563110, 486619000, 1065976034, 1073928258, 1142797381, 1216039659, 1062541899, 2160403857, 1123656737, 31885123, 2290045766, 1275779782, 1020885052, 2081977532, 1876007900, 39278781, 1544117255, 1798757044, 1199136897, 1322419858, 1318858156, 1054523089, 216181635, 2212134159, 2281359701, 1813879333, 1584345847, 756158794, 2251055659, 14266626, 1164609059, 1044209445, 1424085858, 1217583307, 1123408006, 189327845, 1601299011, 1748003000, 1132432833, 1208056498, 1112551970, 2280617348, 2279332091, 52519830, 192454687, 753720141, 91059222, 2289049185, 1749453942, 222783369, 1000315992, 1077398602, 288655014, 1018868549, 2268869305, 1811010670, 582105984, 780006191, 1181378934, 399535591, 1060626514, 1116413941, 1282958977, 1075901972, 2242612261, 248027121, 160993482, 635950060, 89687918, 2279223451, 1150420455, 2252226568, 1095540043, 40448247, 2265639955, 308401320, 1217035361, 1264380835, 2294003094, 2090615526, 887032926, 1415854000, 1949381161, 2268836114, 2177461745, 2280938130, 458590099, 2286706326, 1180309277, 1065656412, 182789575, 2144437634, 1730455650, 296364010, 2265354136, 1582024727, 2086346871, 2296229611, 1159724330, 1281178189, 116264440, 1176507294, 2289001212, 2269131996, 1929003434, 1999737781, 994224763, 140855566, 174580477, 1145051108, 2287945586, 1319829084, 422891160, 1431287942, 1326424245, 1183821408, 2286697395, 2256023014, 2295137835, 162909660, 987297736, 1052045344, 2293943935, 2287408206, 2004114442, 1232521720, 995310746, 2293705234, 205616376, 31922269, 2187972308, 606123055, 1020929525, 148435634, 594105959, 445078356, 2005312782, 1062214290, 757661132, 180983202, 2278682199, 2286769605, 1999180672, 2288144083, 2268693608, 1163139241, 1319389455, 305587902, 87205000, 2268007620, 79453624, 987904379, 1485357533, 1264959153, 1116770368, 2267981601, 1959627728, 1482342209, 1036946973, 242916860, 155095549, 827410441, 1130140272, 1911760452, 229457347, 2026051912, 1469689182, 40349243, 1000728342, 1872427176, 1248378166, 2008064034, 1052138921, 658491232, 59974433, 2238832259, 2231804389, 896712586, 2286254652, 72501954, 70075201, 196824916, 79258389, 2278349571, 2144452611, 2144436634, 1139465186, 1753178185, 2109838107, 1804538804, 2224709185, 1898810674, 1067380118, 2197358747, 1744129957, 1421923634, 2243196009, 2288250105, 288166108, 806600948, 1006935685, 1145847055, 1022105636, 2272230652, 2290961275, 2280242113, 41421162, 1283803035, 2286777899, 983632227, 237114938, 1645611131, 2287536162, 2290542941, 873041252, 1247597564, 2212954511, 1137164267, 2255528822, 1054605193, 1335253710, 1360992795, 1082510579, 2295496594, 1136520604, 1026585644, 2281386868, 2278846968, 1529405712, 193229421, 27044327, 787210669, 1894905746, 1102900672, 82480408, 2287647127, 1112700177, 1217570792, 135839219, 540589080, 306915730, 2223688645, 2089952476, 956887509, 2279233666, 1072596273, 1006324092, 594545083, 125082119, 776722989, 2184493202, 904241671, 1749544980, 1877378889, 1151456122, 617492484, 1063822202, 1086887909, 2231741153, 927615312, 2292036800, 2284138473, 2293501291, 985520335, 2276856351, 2290940470, 2250383486, 2288373511, 2270153609, 2292060102, 2288750776, 902035441, 1765834378, 1413097521, 1344710530, 2288255532, 1022757643, 142903642, 1017702398, 2252613837, 1035008960, 1028201435, 147967638, 1132287966, 43614935, 758209636, 2283858574, 1602496192, 385712396, 1950467073, 2272880088, 236784440, 1045472445, 1731203819, 907910317, 215795788, 434778637, 1009254928, 2244218864, 1046893622, 27812713, 1122162781, 189495802, 1139046870, 939714805, 106026419, 1130132358, 1378664255, 1541663145, 172310252, 1087768206, 47191922, 1055163085, 1790451650, 1645751828, 1960038614, 2101618309, 162092025, 2290638740, 1362012545, 1172291306, 2267489298, 2127393030, 744652816, 1170257193, 1104215300, 1241331255, 1080628105, 181013238, 2290306420, 2286263196, 171444534, 1028870597, 2189483740, 2148162027, 734247399, 2228860637, 2266335193, 1517542738, 1365852322, 2290489694, 2201518786, 2288264906, 2144438451, 2144445489, 776250513, 1122029694, 1195285600, 2286214863, 1179501669, 2144444975, 2143890089, 2276847395, 1186804495, 331145602, 2279225742, 2286453951, 2086661886, 141590080, 107675858, 2210778567, 419401682, 764071018, 1251332707, 2296764910, 1797531471, 141927785, 927296236, 1437609732, 79131875, 1325331523, 504829495, 68869355, 183350397, 228493045, 1805690402, 2218437559, 1106578937, 2138546555, 144947325, 1291283435, 1986067678, 467873161, 868395765, 1101055691, 2292946919, 1443422048, 2225082773, 90340087, 1029552825, 260114946, 175451841, 2280377120, 1089549318, 1378387377, 693211033, 1001729106, 2063637732, 2212394502, 1792399934, 1176151891, 841232154, 1128886188, 1021898143, 1803299848, 646712244, 92761721, 134304482, 184841304, 146732626, 1099495376, 216411815, 480992494, 199494040, 1050275365, 44672077, 38557418, 224523539, 15527484, 325374982, 191262728, 132952595, 1162684051, 985965288, 1069883169, 170339741, 649354544, 1761424189, 1098596222, 1174275765, 130067954, 1287203887, 884786058, 1133200523, 46985308, 193399590, 74494613, 1007729348, 1734319175, 365735231, 917193540, 1120406464, 63019472, 1668870720, 1421389290, 1805068928, 595251680, 648357984, 61839655, 1330257361, 1142797381, 87217494, 1187009635, 1516330637, 1936180706, 1503867999, 1669034850, 132320007, 2111047066, 1393506842, 1110394668, 1074635592, 1149473447, 1206067863, 56095475, 116418125, 209737490, 1410674601, 55636349, 30802116, 1307586654, 144630961, 300603540, 118378913, 1355250729, 38990840, 180827173, 1178372338, 1196059765, 1934972675, 339843420, 206681786, 1816511808, 1551817563, 1046704054, 1137164267, 2353351128, 59153567, 499904791, 99565044, 1857156496, 911717002, 1766320, 1243269814, 141493342, 1153796760, 133830490, 101155749, 158261097, 1010317466, 1282107591, 79852917, 134910036, 2120637240, 1453454971, 304071943, 128661472, 1157114579, 1444720987, 38557418, 37813716, 744424162, 1153173818, 1162030249, 24780398, 1984446232, 1516476229, 140281576, 98400728, 1343874118, 162792670, 365735231, 1814781120, 1832418168, 57840841, 2025849256, 2120155148, 967042915, 1087625831, 539815694, 1808834047, 143318531, 1108652610, 234388974, 99596772, 56696976, 1189953873, 1757813323, 1378387377, 2041395638, 2169538853, 205097440, 1149473447, 1008597590, 1119038248, 451026129, 1142750387, 1984694306, 22092410, 78284719, 1669663340, 989442174, 1459238071, 2077464704, 411947125, 89693663, 61271837, 99989878, 1082131479, 1125886220, 2111964238, 1392833324, 1385068387, 1335346515, 136395905, 560664247, 1879970882, 1614412656, 885583221, 1007389751, 474519902, 2119620578, 1030946828, 1608916559, 109191647, 23271653, 456591625, 2135200698, 1162974216, 1147482376, 1129210695, 297511086, 180827173, 604885787, 1247895204, 1571000587, 1643331387, 71195430, 826895793, 1004963485, 136439623, 1206067863, 1768136482, 1293556406, 2063637732, 213594396, 1576172256, 1554436081, 177699935, 1202603417, 1061534829, 1148990887, 2220086018, 2177118385, 27612181, 1983590617, 1564663626, 27048387, 1960550146, 1584525426, 716842811, 1706309114, 191956830, 109193753, 941783627, 1219161545, 1138408211, 2101348309, 2063730090, 1723266485, 1382502827, 1244988887, 1641942616, 1855182010, 15779158, 134983924, 1950770433, 1118644930, 291944888, 1851295010, 118139131, 923601843, 24463998, 194982788, 27687038, 2139312371, 119915929, 2139166208, 136783989, 75698587, 1060626514, 1796048663, 131731135, 1417329361, 1038378555, 10020303, 2029599502, 1592670226, 1057067450, 1123336794, 2218465366, 2033710328, 1009326400, 328562511, 1458178587, 650293487, 398982038, 100851188, 1196643013, 260114946, 2003299193, 114529125, 1045005775, 317757268, 1076938771, 1488088655, 1231362947, 45924859, 9716292, 1216060482, 1241180667, 134313100, 1081462920, 925180481, 2170816270, 1591605671, 1713053672, 1709862004, 1758611059, 1038199471, 2075647315, 999952129, 1962005608, 2031566090, 77212312, 36857279, 596687137, 85644845, 99105492, 190355923, 465085699, 567180554, 162909660, 102883703, 183552222, 35058064, 644676756, 184709895, 1024964159, 1064375603, 1973590856, 1615229612, 1577601793, 118945299, 2175304807, 1610568319, 1184393845, 837877612, 1008064639, 1371252289, 136955991, 1768146969, 1388405642, 1137301337, 1969959508, 986591370, 129957308, 123644500, 81729330, 196517982, 1240849912, 1297566056, 206856266, 26191903, 861998596, 1425426318, 1113320724, 1005812166, 35150487, 57808676, 181473926, 190588816, 890623258, 124278365, 1913277462, 1544603940, 1419157456, 11518391, 54598088, 1414393495, 1198213802, 1072373984, 1856738589, 299849947, 1103620275, 1188997067, 242801944, 115714821, 40753226, 1249604742, 1580095101, 1833977550, 1177750302, 1008519264, 1446133948, 1301868565, 1260124685, 355637678, 222476389, 1011891759, 162432303, 1381862690, 216029900, 568808331, 168036167, 303967526, 804245587, 169142143, 1565333127, 146101817, 168126233, 86414223, 127454849, 1834154400, 1989240754, 165790776, 1376912484, 206724012, 885940496, 103186543, 76554958, 1136819824, 309112378, 1031056621, 1153888847, 749784184, 144424753, 182827154, 663303464, 688263633, 1095971974, 781162094, 1303440373, 1807192210, 314790528, 993168540, 104659930, 181598699, 684161542, 1032311920, 1038654555, 1200926492, 2096405613, 1150775133, 1929629583, 1550707186, 222629909, 302132281, 1088471505, 1117756582, 743143056, 1174429482, 169524964, 1762357233, 1487855483, 1366480057, 639826673, 1633150994, 341831479, 130478683, 1165888677, 1104314028, 1203918842, 1150938844, 26147580, 114213409, 1069719403, 985748758, 1122962162, 2046698211, 1034462370, 788203447, 166182289, 2166837248, 431822096, 995199318, 419173263, 1383202150, 1228883130, 49878695, 1031261298, 1705902744, 1512047361, 1188236729, 57576751, 2088729553, 977502854, 1411808316, 1100739787, 387138928, 86902265, 1313807260, 2135453194, 81707490, 1011151267, 1384262682, 118973364, 1056392838, 2229774980, 1344466188, 79265738, 1829623138, 1070542641, 129032090, 88376839, 1674966435, 54777339, 1020767242, 182186079, 1080626012, 101635262, 2198551671, 132974497, 569440115, 1020916790, 211428643, 115246574, 211451777, 1083766137, 397676477, 34495639, 27267818, 2158289211, 286938556, 45743332, 192173597, 120437793, 2013889372, 1714177423, 1103308925, 692956353, 389395201, 842606977, 1040630390, 681105436, 655420636, 1868730938, 1237047730, 211521309, 238345008, 116751923, 75459042, 236784440, 999164662, 1092577299, 122883019, 1402401800, 234957721, 1028032073, 1163138714, 2115267856, 1767711573, 1984543942, 1472810697, 806600948, 1213831490, 2229962775, 648726333, 1162692914, 153133019, 1237327162, 172310252, 1531394813, 1314230966, 1066981486, 782767295, 682159997, 919800481, 639966271, 2167007947, 1937239414, 755209492, 2131594474, 198804273, 994185761, 39821034, 99783090, 1037472431, 1083264876, 124475856, 1050362993, 185833699, 1256067388, 416211945, 56768359, 54667420, 1152259506, 325543673, 1483512299, 72154187, 102893208, 849643944, 1964996346, 207581036, 110763772, 602546536, 1170809321, 401732763, 92494882, 1146674641, 108615331, 1230118808, 252774937, 1608916559, 1450994261, 895682033, 1078621507, 1153473548, 2108270661, 508035144, 2109664287, 356489204, 81312594, 2191051483, 1592686816, 1089067945, 191200021, 1606092785, 1064794396, 1225733767, 204019303, 1032033900, 520403793, 97091376, 1053218899, 205275313, 1129266621, 808267634, 734936862, 110723793, 378732229, 987430189, 1083581837, 439875358, 521303103, 77496412, 97215658, 125790156, 108324159, 123039132, 675919076, 1886358783, 336930080, 493837845, 225586156, 1032247466, 1124355599, 1275511851, 63877895, 1607734890, 285892513, 740070497, 229563013, 48241034, 122334463, 79131875, 1062395734, 69956976, 357630417, 783337165, 129435027, 721647205, 1741838127, 992024402, 60292758, 997348516, 1028009229, 1058393124, 308401320, 1063822202, 208088946, 93483893, 1063027606, 39705208, 791026040, 1214144428, 73559594, 1155059930, 1285910820, 524498891, 78728850, 367189691, 1155353566, 1355904218, 104268524, 44511381, 1995611602, 177147990, 195776054, 1556780535, 1575436457, 1245438031, 1840933086, 1136298886, 473393757, 608854694, 137434176, 229018702, 168585913, 1148091394, 80876236, 549862790, 1764980727, 74749887, 146282596, 1232672509, 53890879, 1065694744, 2016952048, 1032170538, 355797354, 1009274475, 1923311481, 148547267, 340434721, 268226529, 1114632745, 2110255131, 2370235660, 204116991) then "Protrader Watches & Handbag"  
when ck.seller_id in (779492056,	1622388726,	1134308905,	1064517454,	1104420930,	81989834,	1220266750,	1675702526,	56264907,	605853908,	438132240,	195651817,	1644692192,	1378664255,	1001729106,	2140414117,	1169202250,	2163678342,	133251303,	2210493957,	1106029208,	2293694103,	127004873,	118945299,	222043520,	182186079) then 'Prelove Protrader'	
when ck.seller_id in (2173190933, 60048792, 1187537835, 1598773338, 701957789, 353759803, 84559342, 1001102981, 1931596549, 1813908589, 1652342234, 1410062562, 87653265, 223665470, 1198402782, 2157976874, 1134356749, 100451494, 145445435, 801437291, 145689878, 166747440, 1487112643, 1031060546, 688465405, 1206560111, 826509308, 1018283539, 1150356354, 1234268383, 361792527, 988136097, 775459505, 1171188043, 2021062629, 299502959, 40248891, 1511863763, 65180630, 198022355, 293055683, 114914015, 74398255, 1232524918, 1461480454, 371252506, 679129159, 121322442, 176125232, 1501922240, 21777880, 971461171, 696104667, 1507718997, 170502368, 123017643, 1061431976, 130361731, 214873474, 73795515, 789270221) then "Protrader SBU"
when cat.CATEG_LVL3_ID in (2213, 63565, 123466, 2203, 63585, 64986, 98440, 63561, 37919, 4708, 100906, 70041, 63518, 98434, 63569, 2212, 70043, 98444, 70039, 2714, 37978, 955, 70032, 2742, 13, 184436, 63581, 98436, 100905, 98931, 66638, 98442, 1207, 37943, 64963, 64979, 70057, 63557, 12, 112089, 63516, 63553, 100907, 63549, 37910, 64961, 37934, 37914, 66851, 25, 1208, 69471, 64971, 112084, 70054, 98454, 70046, 70061, 1212, 96768, 50707, 2818, 63577, 98430, 70044, 70059, 101669, 60201, 37907, 96757, 4175, 4771, 2810, 1219, 37917, 2220, 66637, 66637, 63589, 4228, 60209, 98432, 70050, 18883, 20087, 60330, 37915, 109114, 88, 4219, 1213, 4218, 79949, 2809, 37912, 20117, 98438, 2805, 80102, 37913, 116556, 4221, 100904, 112160, 361, 2803, 63519, 2763, 64981, 4171, 10551, 69472, 4230, 18879, 18880, 20834, 69473, 109108, 97026, 101668, 2795, 63520, 2815, 2221, 70052, 37944, 101665, 100908, 98468, 121472, 70053, 109111, 167948, 2219, 123463, 112872, 1214, 70049, 100925, 109109, 109113, 64958, 91101, 64973, 109107, 112159, 101663, 4229, 2796, 91103, 101666, 4223, 13850, 109110, 18876, 2798, 362, 2224, 123460, 37905, 1210, 2778, 22608, 73469, 2223, 20085, 101662, 109112, 70048, 112869, 462, 97025, 2194, 123462, 101667, 100901, 101661, 23048, 358, 64959, 66834, 97021, 1234, 64991, 27357, 64987, 6114, 65006, 65010, 70063, 65020, 73464, 98466, 2776, 37942, 4176, 79947, 112090, 65009, 91102, 86, 2782, 68267, 4172, 70085, 68268, 4387, 91100, 2761, 75683, 70083, 20088, 156322, 70066, 80099, 64952, 2816, 18913, 453, 2760, 108817, 18917, 101683, 108816, 20095, 18896, 25620, 65014, 70077, 123455, 65022, 101678, 4173, 181727, 37906, 79948, 2789, 64984, 65015, 4222, 123454, 2781, 64983, 98450, 18894, 97024, 2204, 2811, 70084, 145821, 97023, 63548, 64989, 18903, 65012, 66833, 64985, 101670, 70071, 65004, 2797, 123457, 65013, 18906, 112868, 2751, 75685, 70080, 65019, 97022, 4938, 70076, 4233, 70069, 101675, 100928, 37918, 109106, 70068, 70065, 75686, 98448, 101681, 101674, 21197, 184439, 72517, 37908, 123453, 101676, 106459, 72519, 109095, 70074, 179654, 70087, 37975, 101679, 70075, 2769, 63624, 65018, 97020, 98462, 101671, 2756, 72516, 101684, 123458, 72520, 64990, 156320, 98452, 75684, 75681, 37977, 65008, 101680, 123456, 98464, 101673, 101682, 70070, 72518, 184438, 145820, 66850, 37964, 4170, 22422, 70081, 151725, 65005, 65028, 65029, 37976, 592, 105882, 65030, 65027, 63595) then "Protrader Antiques, Pottery & Glass"	
when cat.CATEG_LVL3_ID in (14768, 23022, 61300, 174059, 33579, 33726, 38726, 33559, 9886, 33549, 61409, 174111, 33599, 174107, 61687, 61862, 33605, 174087, 180497) then "Protrader Car Parts"
when cat.CATEG_LVL3_ID in (180425, 173668, 133191, 14766, 27372, 14767, 107060, 173653, 180386, 133208, 133201, 171112, 175607, 180370, 107066, 133196, 133187, 180376, 133192) then "Protrader Car Tuning & Styling"
when cat.CATEG_LVL3_ID in (179690, 22653, 131579, 183320, 260157, 34386, 166365, 32254, 38208, 38204, 54235, 20487, 103430, 3199, 107578, 114397, 20488, 88057, 183322, 20480, 103431, 38199, 20490, 32878, 48319, 175754, 175752, 125085, 115753) then "Protrader Furniture"
when cat.CATEG_LVL3_ID in (79654, 20563, 31587, 46782, 159889, 20580, 20552, 4959, 20549, 38237, 36025, 10034, 16102, 125072, 101415, 41510, 36022, 38225, 31601, 41511, 36017, 36019, 20551, 20569, 36016, 38235, 31586, 20578, 36018, 36023, 41509, 74316, 31588) then "Protrader Home Decor"
when cat.CATEG_LVL3_ID in (171243, 171228, 259103, 171219, 29223, 171210, 1105, 171223, 259106, 11442, 268, 29792, 46752, 69496, 64802, 1140, 91173, 33346, 78622, 171273, 1145, 45673, 101072, 45114, 105967, 162517, 151093, 108869, 98991, 2243, 608, 3984, 609, 101070, 259127, 1139, 259116, 612, 78614, 45115, 1142, 120869, 1141, 1138, 1148, 91176, 52543, 45113, 179212, 101067, 1105, 617, 309, 201, 63821, 41676, 18854, 381, 35029, 52554, 61085, 18839, 176985, 176984, 58698, 2328, 431, 431, 52473, 176983, 29875, 53250, 618, 58717, 42437, 58707, 91500, 2375, 53251, 2335, 46501, 46760, 46497, 31610) then "Protrader Media"
when cat.CATEG_LVL3_ID in (122601, 183454, 106485, 19119, 53600, 183456, 19145, 2885, 183444, 19128, 27394, 112979, 180339, 112972, 106534, 53606, 141755, 19151, 183457, 112992, 2830, 180509, 2535, 123770, 261044, 183455, 31678, 68311, 21551, 6091, 183459, 53599, 68329, 21552, 68296, 27410, 53615, 68340, 27393, 53620, 21544, 180296, 2875, 53658, 68322, 68298, 21553, 183460, 214, 106574, 2839, 68350, 90887, 68341, 68334, 19293, 2881, 68283, 1227, 206, 68295, 53655, 19116, 68287, 68289, 2902, 27360, 101755, 27272, 10366, 13290, 24442, 9047, 106559, 30654, 75701, 53614, 203, 2855, 215, 27284, 27406, 101738, 68317, 2845, 86984, 430, 68294, 75695, 183435, 1223, 68297, 68367, 180508, 68375, 2853, 31635, 213, 53623, 101735, 2892, 428, 10072, 27403, 68376, 72564, 2880, 183436, 27277, 429, 68368, 24410, 31634, 780, 106585, 53660, 183458, 72558, 53619, 53618, 68374, 68286, 101725, 106566, 2897, 27273, 113007, 2832, 75694, 113010, 68302, 101756, 68349, 106552, 68369, 101758, 101757, 101724, 68360, 68359, 68355, 216, 46156, 114299, 27358, 101750, 113006, 113005, 123733, 68357, 68373, 101742, 53650, 31666, 101744, 101743, 179234, 182399, 68377, 106584, 106583, 97089, 101739, 90894, 217, 27405, 68356, 101736, 2884, 123711, 106551, 68358, 106582, 101751, 31679, 68372, 2858, 101753, 112971, 106575, 112969, 101740, 107438, 106577, 68361, 101760, 2846, 101762, 170134, 91574, 68348, 27282, 106581, 2833, 113009, 106576, 106586, 43367, 2867, 101752, 2895, 788, 106578, 37795, 112968, 19143, 261045, 106579, 25548, 666, 101741, 25579, 113008, 106580, 68370, 123782, 68371, 27278, 2956, 27285, 106550, 4240, 2969, 101749, 101761, 112970, 43371, 123781, 101759, 133072, 25583, 183715, 43363, 261041, 170135, 166107, 170131) then "Protrader Memorabilla"
when cat.CATEG_LVL3_ID in (1059, 93427, 4250) then "Protrader Men's Clothing"
when cat.CATEG_LVL3_ID in (62124, 21196, 21208, 2023, 62125, 73931, 75183, 95096, 50814, 30106, 97046, 101685, 75204, 50816, 50815, 109117, 109116, 75205, 123469, 101719, 101686, 101687, 57261, 2906, 21558, 72567, 72568, 109124, 101688, 109125, 101689, 101690, 109123, 112879, 151534, 72577, 72576, 2907, 72578, 117102, 109132, 179985, 179973, 261028, 261030, 179961, 179978, 179965, 384, 180001, 261031, 29723, 178885, 261029, 62143, 71154, 47344, 1301, 16260, 16264, 16263, 23830, 16265, 36317, 91565, 47357, 23825, 101713, 50883, 58128, 151560, 112965, 21213, 21568, 21569, 73180, 21211, 75188, 101730, 91569, 73181, 75189, 1292, 75185, 90879, 75195, 123708, 20871, 20870, 83053, 70898, 62230, 13343, 81624, 2917, 20869, 101727, 148908, 151562, 21233, 260696, 21225, 1303, 260717, 260376, 260672, 260720) then "Protrader Sports"
when cat.CATEG_LVL3_ID in (257942, 259345, 259621, 185035, 259338, 20620, 106121, 79631, 300, 179836, 258026, 62706, 62694) then "Protrader Grocery"
when cat.CATEG_LVL3_ID in (19273, 50204, 11828, 50203, 184227, 184174, 109551, 26224, 92079, 184149, 25307, 25319, 25301, 302, 61673, 31485, 1304, 57004, 184165, 184161, 26220) then "Protrader Office Supplies & Material Handling"
when cat.CATEG_LVL3_ID in (19205, 1634, 49020, 1628, 437, 439, 441, 1036, 7111, 16479, 1633, 1522, 183447, 19001, 258041, 258040, 52338, 21254, 180023, 80546, 180273, 171127, 180268, 180275, 180277, 180276, 171138, 180278, 180274, 177918, 73252, 180269, 97093, 184588, 11737, 61113, 2518, 61114, 11734, 11735, 11736, 11732, 11733, 44005, 1082, 767, 2550, 180350, 40852, 234, 123859, 22150, 2540, 7317, 80547, 36275, 90922, 55415, 19183, 19187, 19186, 2615, 19188, 1189, 2594, 2595, 774, 50296, 70109, 1039, 137891, 113040, 137894, 11742, 137885, 109247, 117216, 73257, 117215, 16515, 11744, 11746, 117211, 117213, 117212, 11745, 137897, 106631, 19017, 181055, 133709, 117210, 101767, 145845, 123844, 61116, 181056, 117214, 1197, 19854, 19181, 374, 56367, 2646, 2574, 158746, 56366, 2576, 168818, 109232, 145860, 106605, 2529, 182187, 182181, 84912, 168248, 34054, 171145, 168247, 4779, 73260, 73263, 137902, 73265, 776, 7319, 73262, 230, 68394, 68386, 68387, 2600, 14737, 56370, 68410, 123852, 73266, 19214, 734, 56369, 123851, 80553, 80551, 123853, 123850, 91594, 2624, 30, 19024, 727, 19180, 719, 229, 11739, 2662, 736, 58799, 2663, 75725, 113041, 117217, 19019, 123854, 31398, 123860, 2543, 56363, 2537, 91596, 145867, 44001, 123871, 44012, 45361, 117218) then "Protrader Toys & Games"
when cat.CATEG_LVL3_ID in (15724, 3034, 169291, 4251) then "Protrader Women's Fashion"
when cat.CATEG_LVL3_ID in (260783, 260773, 36449, 260774) then "Protrader Beauty (Shared)"
when cat.CATEG_LVL3_ID in (20667, 20715, 38250, 42231, 43563, 45733, 71258, 260307, 185114, 260508, 80077, 11071, 168058, 14990, 48647, 111694, 112529, 72406) then "Protrader Appliances, TV & Audio"
when cat.CATEG_LVL3_ID in (167, 169, 31509, 39976, 131542, 158816, 158817, 175671, 182085, 80183, 49230, 117042, 117044, 117045, 171668, 171813, 171814, 171820, 171821, 171826, 171831, 171837, 171839, 171858, 171898, 172510, 182179, 182180, 171485, 179, 111418, 1245, 11195, 11205, 182086, 177, 111422, 164, 1244, 3761, 16145, 27386, 42000, 42017, 44980, 131511, 168059, 170083, 175674, 182089, 182090, 183063) then "Protrader Computing & Tablets"				
when cat.CATEG_LVL3_ID in (25621, 261442, 261410, 135894, 261537, 261157, 261529, 261536, 261417, 261175, 261113, 49767, 261086, 261952, 261440, 261441, 135889, 261182) then "Protrader Motorhome, Roof Rack & Towing"	
else 'Other'
            END AS INVENTORY_PROP,

meta_categ_name,
meta_categ_id,
categ_lvl2_id,
categ_lvl2_name,
categ_lvl3_id,
categ_lvl3_name,
ck.seller_id,
SUM(CK.QUANTITY) AS BI
    ,SUM(CAST(CK.QUANTITY AS DECIMAL(18,2))* CAST(CK.ITEM_PRICE AS DECIMAL(18,2))*CAST(SSA.CURNCY_PLAN_RATE AS DECIMAL(18,2))) AS GMV
   FROM  DW_CHECKOUT_TRANS ck 
    INNER JOIN ( select CURNCY_ID, CURNCY_PLAN_RATE from  ACCESS_VIEWS.SSA_CURNCY_PLAN_RATE_DIM group by 1,2)AS SSA 
        ON SSA.CURNCY_ID = CK.LSTG_CURNCY_ID     
        
    INNER JOIN ( select meta_categ_id, meta_categ_name, CATEG_LVL2_ID, categ_lvl2_name, categ_lvl3_name, categ_lvl3_id,LEAF_CATEG_ID,SITE_ID,BSNS_VRTCL_NAME   from ACCESS_VIEWS.DW_CATEGORY_GROUPINGS group by 1,2,3,4,5,6,7,8,9 )  AS CAT
        ON CK.LEAF_CATEG_ID = CAT.LEAF_CATEG_ID
        AND CK.SITE_ID = CAT.SITE_ID
        
    INNER JOIN ACCESS_VIEWS.DW_CAL_DT AS CAL
        ON CAL.CAL_DT = CK.CREATED_DT
        AND CAL.RETAIL_YEAR in (2021, 2022) and age_for_rtl_week_id <= -1 
        
/* inner join  (select user_id from P_awang_opt_T.protrader_2021_Q2 group by 1) fs
on ck.seller_id = fs.user_id */

    WHERE 1=1
and  SLR_CNTRY_ID = 3 --UK sellers
and ck.site_id = 3 
AND RPRTD_WACKO_YN = 'N'
        AND AUCT_END_DT >= '2017-12-20'
        AND CREATED_DT >= '2017-12-20'     
    GROUP BY 1,2,3,4,5,6,7,8,9,10,11) ;
 
	drop table if exists P_awang_ops_T.prot_samp_1_gmv3;
CREATE TABLE  P_awang_ops_T.prot_samp_1_gmv3 AS
 
 (select 
retail_year,
retail_week,
new_vertical,
inventory_prop,
seller_id,
user_slctd_id,
sum(BI) as BI,
sum(GMV) as GMV

from P_awang_ops_T.prot_samp_1_gmv2 f
inner join dw_users u on f.seller_id = u.user_id

where inventory_prop <> 'other'

group by 1,2,3,4,5,6);

-- this is the weekly capture table - need to be updated to insert in subsquent weeks
/* select a.*,
SELLER_STANDARD
from P_awang_ops_T.prot_samp_1_foutput2 a
left outer join P_awang_ops_T.prot_samp_1_sellerst b
on a.seller_id = b.seller_id;

select retail_year,
retail_week from P_awang_ops_T.prot_samp_1_gmv3 group by 1,2
*/



